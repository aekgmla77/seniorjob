<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.company.users.service.impl.UsersMapper">
	<!-- 전체 조회 -->
	<select id="getUsersList" resultType="com.company.users.service.UsersVO">
	SELECT     ID
			  ,PASSWORD
			  ,ADDRESS
			  ,PHONENUM
			  ,EMAIL
			  ,BIRTH
			  ,AUTH
			  ,NAME
			  ,LOG_DATE
	FROM USERS
	</select>
	<!-- 단건 조회 -->
	<select id ="getUsers" resultType="com.company.users.service.UsersVO" parameterType="com.company.users.service.UsersVO">
	SELECT     ID
			  ,PASSWORD
			  ,ADDRESS
			  ,PHONENUM
			  ,EMAIL
			  ,BIRTH
			  ,AUTH
			  ,NAME
			  ,LOG_DATE
			  ,POSTCODE
			  ,DETAILADDRESS
			  ,EXTRAADDRESS
			  FROM USERS
	WHERE ID = #{id}		  
	</select>

	
	<!-- login -->
	<select id ="logCheck" resultType="com.company.users.service.UsersVO" parameterType ="com.company.users.service.UsersVO">
		SELECT ID,
			   PASSWORD,
			   NAME,
			   AUTH	
		FROM USERS
		WHERE ID = #{id}    
	</select>
	
	<!-- 아이디 중복체크 -->
	<select id="idCheck" resultType="int">
	SELECT COUNT(*) FROM USERS
	WHERE ID = #{id}
	</select>
	
	<!-- 패스워드 체크 -->
	<select id ="passCheck" resultType="int">
	SELECT COUNT(*) FROM USERS
	WHERE ID = #{id}
	AND PASSWORD = #{password}
	</select>
	
	<!-- 회원가입 -->
	<insert id="insertUsers" parameterType="com.company.users.service.UsersVO">
	INSERT INTO USERS(ID,
					PASSWORD,
					ADDRESS,
					PHONENUM,
					EMAIL,
					BIRTH,
					NAME)
	VALUES(			#{id},
					#{password},
					#{address},
					#{phonenum},
					#{email},
					#{birth},
					#{name})
	</insert>
	
	<!-- 패스워드 변경 -->
	<update id="updateInfo" parameterType="com.company.users.service.UsersVO">
		UPDATE USERS SET PASSWORD = #{password} 
						 WHERE ID = #{id}
	</update>
	
	<!-- 양소민 수정 -->
	<!-- 회원정보 업데이트 -->
	<update id="updateUsers" parameterType="com.company.users.service.UsersVO">
		UPDATE USERS SET <if test="postcode != null and postcode !=''">postcode=#{postcode},</if>
					     <if test="address != null and address !=''">ADDRESS= #{address},</if>
					     <if test="extraaddress != null and extraaddress !=	''">extraaddress=#{extraaddress},</if>	
					     <if test="detailaddress != null and detailaddress != ''">detailaddress=#{detailaddress},</if>
						 <if test="phonenum !=null and phonenum !=''">PHONENUM= #{phonenum},</if>
						 <if test="email !=null and email !=''">EMAIL= #{email},</if>
						 <if test="birth !=null and birth !=''">BIRTH= #{birth},</if>
						 <if test="name !=null and name !=''">NAME= #{name}</if>	
						 WHERE ID = #{id}
	</update>
	
	<!-- 양소민 추가 -->
	<!-- 마이페이지에서 자격증/경력인증서 등록 -->
	<insert id="insertCerti" parameterType="UsersVO">
	INSERT INTO USERCERTI(ID,
							NO
							<if test="certi_name != null and certi_name !=''">,CERTI_NAME</if>
							<if test="certi_place != null and certi_place !=''">,CERTI_PLACE</if>
							<if test="certi_no != null and certi_no !=''">,CERTI_NO</if>
							<if test="certi_date != null and certi_date !=''">,CERTI_DATE</if>
							<if test="carrer_certi != null and carrer_certi !=''">,CARRER_CERTI</if>
							)
				VALUES( 
							#{id},
							USERCERTI_SEQ.NEXTVAL
							<if test="certi_name != null and certi_name !=''">,#{certi_name}</if>
							<if test="certi_place != null and certi_place !=''">,#{certi_place}</if>
							<if test="certi_no != null and certi_no !=''">,#{certi_no}</if>
							<if test="certi_date != null and certi_date !=''">,#{certi_date}</if>
							<if test="carrer_certi != null and carrer_certi !=''">,#{carrer_certi}</if>
							
						)
				
	</insert>
	
	</mapper>
